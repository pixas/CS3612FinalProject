\documentclass{article}

\usepackage{geometry}

\geometry{a4paper}

% \usepackage[UTF8, heading = false, scheme = plain]{ctex}%格式

% \usepackage{ctex}

%\usepackage{authblk} %添加机构 安装preprint后可用

\usepackage{graphicx} %添加图片
\usepackage{listings}
\usepackage{float}  %设置图片浮动位置的宏包
\usepackage{subfigure}  %插入多图时用子图显示的宏包
\usepackage{amsthm}
\usepackage{booktabs}       % professional-quality tables
\usepackage{amsfonts}       % blackboard math symbols
\usepackage{nicefrac}       % compact symbols for 1/2, etc.
\usepackage{microtype}      % microtypography
\usepackage{multirow}
\usepackage{caption}
\usepackage{times}
% \usepackage{subcaption}
% \usepackage{fontspec} % 定制字体

\usepackage{xcolor} % 定制颜色
\definecolor{mygreen}{rgb}{0,0.6,0}
\definecolor{mygray}{rgb}{0.5,0.5,0.5}
\definecolor{mymauve}{rgb}{0.58,0,0.82}
\lstset{ %
backgroundcolor=\color{white},      % choose the background color
basicstyle=\footnotesize\ttfamily,  % size of fonts used for the code
columns=fullflexible,
tabsize=4,
breaklines=true,               % automatic line breaking only at whitespace
captionpos=b,                  % sets the caption-position to bottom
commentstyle=\color{mygreen},  % comment style
escapeinside={\%*}{*},        % if you want to add LaTeX within your code
keywordstyle=\color{blue},     % keyword style
stringstyle=\color{mymauve}\ttfamily,  % string literal style
frame=single,
rulesepcolor=\color{red!20!green!20!blue!20},
% identifierstyle=\color{red},
language=python,
}


\usepackage{amsmath}

\renewcommand{\vec}[1]{\boldsymbol{#1}} % 生产粗体向量，而不是带箭头的向量
\renewcommand{\thesubfigure}{(\arabic{subfigure})}
\usepackage{amssymb}

\usepackage{booktabs} % excel导出的大表格

\usepackage{hyperref}

%\newtheorem{definition}{Definition} %英文
% \setCJKmainfont{hk4e_zh-cn.ttf}     % 语义和语法同fontspec
% \setCJKsansfont{hk4e_zh-cn.ttf}
% \setCJKmonofont{hk4e_zh-cn.ttf}
% \setmainfont{Times New Roman}
% \setsansfont{hk4e_zh-cn.ttf}
% \setmonofont{hk4e_zh-cn.ttf}
%\newtheorem{theorem}{Theorem}
\geometry{a4paper,scale=0.8}
% \newtheorem{definition}{定义} %中文

% \newtheorem{lemma}{引理}

% \newtheorem{theorem}{定理}

%\newenvironment{proof}{{\noindent\it 证明}\quad}{\hfill □ \square□\par}

\DeclareMathOperator{\Ima}{Im}%定义新符号

\DeclareMathOperator{\Rank}{rank}%定义求秩算子

\title{Machine Learning Personal Project}

\author{Jiang Shuyang \\ Email: \href{mailto:jiangshuyang@sjtu.edu.cn}{jiangshuyang@sjtu.edu.cn}}

%\affil{中国科学院} 
%需要把上面的\usepackage{authblk}取消注释

%date{}

\begin{document}

\maketitle

\section{Introduction}
In this project, I finish the basic task, i.e., image classification on MNIST dataset. Besieds, I also finish image generation with VAE and sentiment analysis with LSTM. I will in detail illustrate the model architectures in each task, final result on test set and corresponding visualization results.

\input{image_class.tex}
\input{image_gen.tex}
\input{sst.tex}




\newpage
\section{Appendix}
\label{code:tsne}
t-SNE Implementation. Only paste function names and anyone can refer to the source code for complete implementation.
\begin{lstlisting}

class MytSNE:
    def __init__(self, n_components=2, max_iter=1000, neighbors=30,
                 learning_rate=200, embed_scale=0.1, tol=1e-5) -> None:
        self.n_components=n_components
        self.max_iter = max_iter
        self.neighbors = neighbors
        self.learning_rate = learning_rate
        self.embed_scale = embed_scale
        self.tol = tol
    
    def fit_transform(self, X: np.ndarray):
        # Omit
        return Y

    def calc_matrix_P(self, X: np.ndarray):
        # Omit
        return P
    
    def calc_p(self, D: np.ndarray, entropy: float, iter_times=50):
        # Omit
        return P

    def calc_entropy(self, D: np.ndarray, beta: float):
        # Omit
        return H
    
    def calc_matrix_Q(self, Y: np.ndarray):
        # Omit
        return Q
    
    def calc_grad(self, P: np.ndarray, Q: np.ndarray, Y: np.ndarray):
        # Omit
        return grad

    def calc_loss(self, P: np.ndarray, Q: np.ndarray):
        kl_loss = np.sum(P * np.log(P / Q))
        return kl_loss
        
\end{lstlisting}

\end{document}
